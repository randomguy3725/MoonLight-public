/*
 * MoonLight Hacked Client
 *
 * A free and open-source hacked client for Minecraft.
 * Developed using Minecraft's resources.
 *
 * Repository: https://github.com/randomguy3725/MoonLight-public
 *
 * Author(s): [RandomGuy & opZywl]
 */
package wtf.moonlight.features.modules.impl.exploit;

import net.minecraft.network.Packet;
import net.minecraft.network.play.client.C03PacketPlayer;
import wtf.moonlight.events.annotations.EventTarget;
import wtf.moonlight.events.impl.packet.PacketEvent;
import wtf.moonlight.events.impl.player.TeleportEvent;
import wtf.moonlight.features.modules.Module;
import wtf.moonlight.features.modules.ModuleCategory;
import wtf.moonlight.features.modules.ModuleInfo;
import wtf.moonlight.features.values.impl.ModeValue;

@ModuleInfo(name = "NoRotate", category = ModuleCategory.Exploit)
public class NoRotate extends Module {
    public final ModeValue mode = new ModeValue("Mode", new String[]{"Edit","Packet"}, "Edit", this);
    private float yaw, pitch;
    private boolean teleport;

    @EventTarget
    public void onTeleport(TeleportEvent event){

        switch (mode.get()){
            case "Packet":
                event.setYaw(mc.thePlayer.rotationYaw);
                event.setPitch(mc.thePlayer.rotationPitch);
                break;
            case "Edit":
                this.yaw = event.getYaw();
                this.pitch = event.getPitch();

                event.setYaw(mc.thePlayer.rotationYaw);
                event.setPitch(mc.thePlayer.rotationPitch);

                this.teleport = true;
                break;
        }
    }

    @EventTarget
    private void onPacket(PacketEvent event) {
        Packet<?> packet = event.getPacket();

        if (mode.is("Edit") && this.teleport && packet instanceof C03PacketPlayer.C06PacketPlayerPosLook c06PacketPlayerPosLook) {

            c06PacketPlayerPosLook.yaw = this.yaw;
            c06PacketPlayerPosLook.pitch = this.pitch;

            event.setPacket(c06PacketPlayerPosLook);

            this.teleport = false;
        }
    }
}
